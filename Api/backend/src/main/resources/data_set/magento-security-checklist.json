{
  "id": 121,
  "header": "magento-security-checklist",
  "topicList": [
    "Custom code",
    "Extension security checklist",
    "Magento Admin settings",
    "Server settings",
    "SSH access",
    "Regular Maintenance",
    "Secure Development processes",
    "Testing environments",
    "Magento Core",
    "External security concerns",
    "Additional resources"
  ],
  "itemGroups": [
    {
      "topic": "Custom code",
      "items": [
        {
          "title": "Are all inputs validated on the server side?"
        },
        {
          "title": "(TODO: Link to validation tutorial)"
        },
        {
          "title": "Are you sanitizing all inputs also? (eg: casting to integers if a number is expected?)"
        },
        {
          "title": "Are you correctly protecting your code against PHP string comparison vulnerabilities? (eg. == vs ===)"
        },
        {
          "title": "<a href=\"https://hydrasky.com/network-security/php-string-comparison-vulnerabilities/\">Blog post explaining vulnerability</a>"
        },
        {
          "title": "Are you using Magento built in <code>form_key</code> validation on all custom forms?"
        },
        {
          "title": "(TODO: Link for more info on CSRF Anti-forgery tokens)"
        },
        {
          "title": "Are you properly escaping all output to screen using <code>escapeHtml()</code>, <code>escapeJs()</code> and similar functions?"
        },
        {
          "title": "Are you setting <code>HttpOnly</code> and <code>Secure</code> flag on any custom cookies?"
        },
        {
          "title": "Are you using the <code>Magento\\Config\\Model\\Config\\Backend\\Encrypted</code> backend model for sensitive API data to be stored in the DB? eg: payment gateway keys."
        },
        {
          "title": "Are you using any dynamic code execution functions like <code>eval</code>, <code>shell_exec</code> or backticks (``)?"
        },
        {
          "title": "<a href=\"https://stackoverflow.com/questions/3115559/exploitable-php-functions\">Exploitable PHP functions</a>"
        },
        {
          "title": "Are you building MySQL queries properly and not using direct queries?"
        },
        {
          "title": "Are all sensitive or system specific settings treated as sensitive configuration?"
        },
        {
          "title": "<a href=\"https://devdocs.magento.com/guides/v2.3/extension-dev-guide/configuration/sensitive-and-environment-settings.html#how-to-specify-values-as-sensitive-or-system-specific\">DevDocs on sensitive configuration</a>"
        },
        {
          "title": "Are you adhering to the Magento Technical Guidelines when developing custom code?"
        },
        {
          "title": "<a href=\"https://devdocs.magento.com/guides/v2.3/coding-standards/technical-guidelines.html\">Magento Technical Guidelines</a>"
        },
        {
          "title": "Are you sanitizing/ filtering user inputs and dynamic data against malicious code to prevent cross-site scripting (XSS)?"
        },
        {
          "title": "<a href=\"https://devdocs.magento.com/guides/v2.3/extension-dev-guide/xss-protection.html\">XSS prevention strategies</a>"
        }
      ]
    },
    {
      "topic": "Extension security checklist",
      "items": [
        {
          "title": "Do you have the latest version of all the extensions being used on the site?"
        },
        {
          "title": "<a href=\"https://github.com/gwillem/magevulndb\">Magento Vulnerable extensions</a>"
        },
        {
          "title": "Are all your extensions using Magento ACL properly to limit the scope of users?"
        },
        {
          "title": "(TODO: ACL tutorial)"
        },
        {
          "title": "Did you perform a security audit on 3rd party extensions used on the store?"
        },
        {
          "title": "At the very least execute Extension Code Review against <a href=\"https://github.com/magento/magento-coding-standard\">Magento Coding Standards</a>"
        },
        {
          "title": "Use a <a href=\"https://packagist.org/packages/roave/security-advisories\">tool</a> that reports the usage of dependencies with known security vulnerabilities"
        },
        {
          "title": "Review if Passwords/API Credentials or other Sensitive Data stored by 3rd Party Extension are not save in Database using <code>plaintext</code>!"
        },
        {
          "title": "(TODO: Link to more sample tools to help perform security audit on extensions)"
        },
        {
          "title": "Review the need of using <code>Magento_Swagger</code> &amp; <code>Magento_Version</code> Modules in Production Environment (consider to <code>Disable</code> those CORE Modules or at the very least restrict access to <code>hostname/magento_version</code> and <code>hostname/swagger</code>)"
        },
        {
          "title": "Review the need of using <code>hostname/setup</code> in Production Environment (consider to restrict the access)"
        },
        {
          "title": "Are you updating the 3rd party extensions on a regular basis?"
        }
      ]
    },
    {
      "topic": "Magento Admin settings",
      "items": [
        {
          "title": "Are you using a custom Magento Admin URL?"
        },
        {
          "title": "Is the secret key added to admin URLs?"
        },
        {
          "title": "Is access to your Admin URL IP whitelisted or protected via VPN?"
        },
        {
          "title": "If you can't make the Admin URL private, are you using CAPTCHA/ reCAPTCHA for admin login form?"
        },
        {
          "title": "Is the admin session lifetime set to a reasonable configuration (1-2hrs)?"
        },
        {
          "title": "Are you reinforcing admin password renewal at least every 3 months?"
        },
        {
          "title": "Are you disabling the admin account sharing?"
        },
        {
          "title": "Are you limiting the failed admin login attempts to a reasonable number of times (eg 3)?"
        },
        {
          "title": "Confirm that Web -&gt; Default Cookie Settings -&gt; Use HTTP Only is not disabled?"
        },
        {
          "title": "Are you using 2FA for your admin login?"
        },
        {
          "title": "Are there any old/unused admin users which were created for testing or development that should be removed?"
        },
        {
          "title": "Are you using CAPTCHA/ reCAPTCHA for customer facing web forms?"
        }
      ]
    },
    {
      "topic": "Server settings",
      "items": [
        {
          "title": "Is your site logging information in a format that is easily reviewed by your team?"
        },
        {
          "title": "Is your site logging any potentially sensitive information?"
        },
        {
          "title": "Is you TLS certificate properly installed and your OpenSSL configuration set to high standards?"
        },
        {
          "title": "<a href=\"https://www.ssllabs.com/ssltest/\">SSL Server Test</a>"
        },
        {
          "title": "Do you have notifications turned on for filesystem integrity?"
        },
        {
          "title": "Disable Server Signature:"
        },
        {
          "title": "<a href=\"http://nginx.org/en/docs/http/ngx_http_core_module.html#server_tokens\">Nginx</a> - <code>server_tokens off;</code>"
        },
        {
          "title": "<a href=\"https://httpd.apache.org/docs/2.4/mod/core.html#serversignature\">Apache - ServerSignature Directive</a> - <code>ServerSignature Off</code>"
        },
        {
          "title": "<a href=\"https://httpd.apache.org/docs/2.4/mod/core.html#servertokens\">Apache - ServerTokens Directive</a> - <code>ServerTokens Prod</code>"
        },
        {
          "title": "Set secure PHP settings in <code>php.ini</code>"
        },
        {
          "title": "Minimize the number of PHP modules you have installed. Remove any not needed by Magento."
        },
        {
          "title": "Disable PHP version exposure: <code>expose_php = Off</code>"
        },
        {
          "title": "Disable Script Name exposure for <code>mail()</code> function: <code>mail.add_x_header = Off</code>"
        },
        {
          "title": "Disable errors: <code>display_errors = Off</code>"
        },
        {
          "title": "Set httponly flag as default for cookies: <code>session.cookie_httpsonly = On</code>"
        },
        {
          "title": "Set secure flag as default for cookies: <code>session.cookie_secure = On</code>"
        },
        {
          "title": "Disable remote file inclusion: <code>allow_url_fopen = Off</code> and <code>allow_url_include = Off</code>"
        },
        {
          "title": "Set <code>open_basedir</code> and <code>upload_tmp_dir</code> to appropriate directories for you distro/installation"
        },
        {
          "title": "Are there any (development) files or database dumps lying around in the production document root that are not intended for public usage (for example info.php, phpinfo.php, dbdump.sql.gz)?"
        },
        {
          "title": "Does an unnecessary <code>.git</code> folder or <code>.gitignore</code> file exist in your production filesystem?"
        },
        {
          "title": "Are any required files for server operation readable publicly? eg: <code>php.ini</code> or <code>.user.ini</code>"
        },
        {
          "title": "Do all your folders in your docroot have the <a href=\"https://devdocs.magento.com/guides/v2.3/config-guide/prod/prod_file-sys-perms.html\">appropriate permissions set</a>? (for example var/logs, /var/report, install)?"
        },
        {
          "title": "Have you analyzed your HTTP response headers for problems?"
        },
        {
          "title": "<a href=\"https://securityheaders.com/\">Analyse your HTTP response headers</a>"
        },
        {
          "title": "Unless you have specific requirements for them have you limited all requests to <code>GET</code> and <code>PUT</code>?"
        },
        {
          "title": "Are you disabling the directory paths indexing/ listing?"
        },
        {
          "title": "Can you set your Magento php files installation as read-only?"
        },
        {
          "title": "Do you have a process for matching the production server files with a known good state?"
        },
        {
          "title": "<em>TODO: need to add mod_security information</em>"
        },
        {
          "title": "Is the webserver &amp; Magento’s app/etc/env.php configured <a href=\"https://devdocs.magento.com/guides/v2.3/install-gde/tutorials/change-docroot-to-pub.html\">to use /pub as document root</a>?"
        },
        {
          "title": "Is /media/ accesible?"
        },
        {
          "title": "Are there any executable files inside /media/?"
        },
        {
          "title": "Are you using up-to-date services (<a href=\"https://devdocs.magento.com/guides/v2.3/install-gde/system-requirements-tech.html\">where compatibility allows it</a>)?"
        },
        {
          "title": "Are you disabling or returning 404 the requests to pages with unused forms?"
        }
      ]
    },
    {
      "topic": "SSH access",
      "items": [
        {
          "title": "Are you granting server access only by SSH connection and usage of individual users with individual keys?"
        },
        {
          "title": "Are you providing access only to the people who actually need it, and only to the resources they need?"
        },
        {
          "title": "Are you documenting all SSH keys and update them as team members change the keys or are added/ removed to/ from the team?"
        },
        {
          "title": "Are you reviewing all access by project team members and staff periodically (at least every 3 months)?"
        },
        {
          "title": "Are you disabling SSH access for root user?"
        },
        {
          "title": "Is the default SSH port changed from 22 to something else (eg 2233)?"
        },
        {
          "title": "Is SSH password authentication disabled?"
        }
      ]
    },
    {
      "topic": "Regular Maintenance",
      "items": [
        {
          "title": "Do you have an Incident Response Plan implemented and tested (mock scenario)?"
        },
        {
          "title": "<a href=\"https://www.github.com/talesh/response\">Magento Incidence Response Plan template</a>"
        },
        {
          "title": "Do you have a person with regular scheduled time to review log messages for suspicious behaviour?"
        },
        {
          "title": "What is your process for dealing with IP address that are attempted to directory bruteforcing?"
        },
        {
          "title": "Do you have automated offsite backups for your site enabled?"
        },
        {
          "title": "Are these backups encrypted and on a non-public location?"
        },
        {
          "title": "Are these backups treated with the same level of security as your existing code?"
        }
      ]
    },
    {
      "topic": "Secure Development processes",
      "items": [
        {
          "title": "Do you have a process for sanitizing production data for developers?"
        },
        {
          "title": "<a href=\"https://github.com/netz98/n98-magerun2\">n98-magerun2 is recommended</a>"
        },
        {
          "title": "Do you have a list of developers/support staff with full access to your production systems and a process for accessing them?"
        }
      ]
    },
    {
      "topic": "Testing environments",
      "items": [
        {
          "title": "Are you blocking access to testing machines and use a whitelist for IPs that really need to access these resources?"
        },
        {
          "title": "Are you keeping a catalog of all IPs - who and why they have access over HTTP to these machines and periodically check if they still need the access?"
        },
        {
          "title": "Are you using <a href=\"https://devdocs.magento.com/guides/v2.3/config-guide/prod/config-reference-var-name.html\">environment variables</a> to overwrite any production URL for payment processors, 3rd party API integrations or other sensitive configurations which you might overlook when updating the testing machine database with a backup from production?"
        }
      ]
    },
    {
      "topic": "Magento Core",
      "items": [
        {
          "title": "Does your site contain the latest security patches and updates?"
        },
        {
          "title": "<a href=\"https://www.magereport.com/\">Magereport community scanner</a>"
        },
        {
          "title": "<a href=\"https://account.magento.com/scanner\">Magento security scanner</a>"
        },
        {
          "title": "Are you applying the security patches' new standards/ changes to the custom code developed so far? Without this, the patch can be useless (the system is as strong as its weakest link)."
        },
        {
          "title": "Do you have a person with a subscription to security notices from Magento security blog for urgent patches/updates?"
        },
        {
          "title": "<a href=\"https://magento.com/security\">Magento Security center</a>"
        },
        {
          "title": "Do you have a recurring reminder to execute regularly review validity of existing Admin accounts (including the allocated resources)?"
        },
        {
          "title": "Recommended monthly"
        },
        {
          "title": "Are you reviewing on a regular basis (at least every 3 months) the existing API integrations and the allocated resources?"
        }
      ]
    },
    {
      "topic": "External security concerns",
      "items": [
        {
          "title": "If you are using a Web Application Firewall (WAF) does it provide virtual patching and how do you keep it up to date?"
        }
      ]
    },
    {
      "topic": "Additional resources",
      "items": [
        {
          "title": "Magento User Guide's <a href=\"https://magento.com/security/best-practices\">Security Best Practices</a>"
        }
      ]
    }
  ],
  "sourceUrl": "https://example.com"
}